import hid

HEX_PAYLOAD = "06040000010080000003030100000404070005200100000000000100040200ff0600000001000402000000000000000000000000000000000000000000000000ffff03400447044704470447044704470447044704470447044704470447044704470447043704370437074707470744074407440744074407440744040404040404040404045aa5000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"

VID = 0x258A
PID = 0x010C

data = bytes.fromhex(" ".join(HEX_PAYLOAD.split()))
print(f"Prepared feature report of length {len(data)} bytes")
assert len(data) == 520
assert data[0] == 0x06

dev = None
for d in hid.enumerate(VID, PID):
    if d.get("usage_page") == 0xFF00 and d.get("interface_number") == 1:
        dev = d
        break

if not dev:
    raise RuntimeError("Kreo Swarm vendor HID interface not found")

h = hid.device()
h.open_path(dev["path"])
h.send_feature_report(data)
h.close()

print("RGB feature report sent successfully")
